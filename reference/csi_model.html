<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Base class for CSI models. — csi_model • subdiff</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Base class for CSI models. — csi_model"><meta property="og:description" content="Base class for CSI models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">subdiff</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.1.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/subdiff.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/msd_conventions.html">Visual Check of Subdiffusion Estimators</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlysy/subdiff/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Base class for CSI models.</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlysy/subdiff/blob/main/R/csi_model.R" class="external-link"><code>R/csi_model.R</code></a></small>
    <div class="hidden name"><code>csi_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Base class for CSI models.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>Let <code>Xt</code> denote an <code>N x d</code> matrix of particle positions recorded at intervals of <code>dt</code>, where <code>d = 1,2,3</code> is the number of recorded dimensions.  A CSI model for <code>Xt</code> is of the form</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Xt <span class="ot">=</span> <span class="fu">R</span>(phi) mu <span class="sc">+</span> Sigma<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>} Z,</span></code></pre><p></p></div>
<p>where:</p><ul><li><p><code>R(phi)</code> is an <code>N x p</code> matrix of drift terms, possibly dependent on a parameter <code>phi</code>.  In most cases though, <code>R(phi) = t((1:N-1) * dt)</code> is used to model linear drift.</p></li>
<li><p><code>mu</code> is a <code>p x d</code> matrix of drift parameters.  For linear drift, it represents the drift velocity in each of the <code>d</code> dimensions.</p></li>
<li><p><code>Sigma</code> is a <code>d x d</code> variance matrix.</p></li>
<li><p><code>Z</code> is an <code>N x d</code> matrix where each column is an iid realization of <code>N</code> values of a Gaussian continuous stationary increments (CSI) process.  Such processes are completely determined by the mean square displacement (MSD) function</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">MSD_Z</span>(h) <span class="ot">=</span> E[ (Z_{i<span class="sc">+</span>h,j}, Z_{i,j})<span class="sc">^</span><span class="dv">2</span> ],</span></code></pre><p></p></div>
<p>where the MSD function also depends on the parameter <code>phi</code>.</p></li>
</ul><p>The <code>csi_model</code> class is a base class for CSI models which requires the user to specify the drift and msd functions, based on which it provides generic methods for parameter inference, simulation, etc.  For further details about the CSI model see <code><a href="../articles/subdiff.html">vignette("subdiff")</a></code>.</p>
    </div>
    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>phi_names</code></dt>
<dd><p>Vector of kernel parameter names (on the original scale).  Setting to <code>NULL</code> means there are no kernel parameters (<code>n_phi = 0</code>).</p></dd>


</dl><p></p></div>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>Xt</code></dt>
<dd><p>Particle trajectory.  A matrix where row <code>n</code> is the position of the particle at time <code>t = n * dt</code> and each column is a measurement dimension.  Only reallocates memory for the internal Toeplitz matrix if necessary.</p></dd>


<dt><code>dt</code></dt>
<dd><p>Interobservation time (scalar).</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-csi_model-trans"><code>csi_model$trans()</code></a></p></li>
<li><p><a href="#method-csi_model-itrans"><code>csi_model$itrans()</code></a></p></li>
<li><p><a href="#method-csi_model-acf"><code>csi_model$acf()</code></a></p></li>
<li><p><a href="#method-csi_model-msd"><code>csi_model$msd()</code></a></p></li>
<li><p><a href="#method-csi_model-drift"><code>csi_model$drift()</code></a></p></li>
<li><p><a href="#method-csi_model-get_omega"><code>csi_model$get_omega()</code></a></p></li>
<li><p><a href="#method-csi_model-trans_full"><code>csi_model$trans_full()</code></a></p></li>
<li><p><a href="#method-csi_model-itrans_full"><code>csi_model$itrans_full()</code></a></p></li>
<li><p><a href="#method-csi_model-nlp"><code>csi_model$nlp()</code></a></p></li>
<li><p><a href="#method-csi_model-nu_hat"><code>csi_model$nu_hat()</code></a></p></li>
<li><p><a href="#method-csi_model-loglik"><code>csi_model$loglik()</code></a></p></li>
<li><p><a href="#method-csi_model-fisher"><code>csi_model$fisher()</code></a></p></li>
<li><p><a href="#method-csi_model-get_vcov"><code>csi_model$get_vcov()</code></a></p></li>
<li><p><a href="#method-csi_model-fit"><code>csi_model$fit()</code></a></p></li>
<li><p><a href="#method-csi_model-resid"><code>csi_model$resid()</code></a></p></li>
<li><p><a href="#method-csi_model-sim"><code>csi_model$sim()</code></a></p></li>
<li><p><a href="#method-csi_model-new"><code>csi_model$new()</code></a></p></li>
<li><p><a href="#method-csi_model-clone"><code>csi_model$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-csi_model-trans"></a><div class="section">
<h3 id="method-trans-">Method <code>trans()</code><a class="anchor" aria-label="anchor" href="#method-trans-"></a></h3>
<p>Transform kernel parameters from regular to computational basis.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">trans</span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>Kernel parameters in the computational basis.</p>
</div>

</div><p></p><hr><a id="method-csi_model-itrans"></a><div class="section">
<h3 id="method-itrans-">Method <code>itrans()</code><a class="anchor" aria-label="anchor" href="#method-itrans-"></a></h3>
<p>Transform kernel parameters from computational to regular basis.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">itrans</span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>psi</code></dt>
<dd><p>Kernel parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Kernel parameters in the original basis.</p>
</div>

</div><p></p><hr><a id="method-csi_model-acf"></a><div class="section">
<h3 id="method-acf-">Method <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf()</a></code><a class="anchor" aria-label="anchor" href="#method-acf-"></a></h3>
<p>Increment autocorrelation function.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">acf</span><span class="op">(</span><span class="va">phi</span>, <span class="va">dt</span>, <span class="va">N</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>dt</code></dt>
<dd><p>Interobservation time.</p></dd>


<dt><code>N</code></dt>
<dd><p>Number of trajectory increments.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A vector of <code>N</code> autocorrelations.</p>
</div>

</div><p></p><hr><a id="method-csi_model-msd"></a><div class="section">
<h3 id="method-msd-">Method <code>msd()</code><a class="anchor" aria-label="anchor" href="#method-msd-"></a></h3>
<p>Position mean square displacement function.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">msd</span><span class="op">(</span><span class="va">phi</span>, <span class="va">t</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>t</code></dt>
<dd><p>Vector of time points at which to calculate the MSD.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>This method can be directly supplied by the derived class.  Otherwise, it uses <code><a href="https://rdrr.io/pkg/SuperGauss/man/acf2msd.html" class="external-link">SuperGauss::acf2msd()</a></code> to calculate the MSD from <code>self$acf()</code> at intervals of <code>self$dt</code>, and interpolates linearly between these timepoints at the desired values in <code>t</code>.</p>
<p>The <code>self$msd()</code> method is defined this way because the MSD of some CSI models (e.g., <code>fsd</code> and <code>farma</code>) is not defined in continuous time, and thus intrinsically depends on the interobservation time <code>dt</code>.  Thus, the default <code>self$msd()</code> method throws an error if <code>self$dt</code> has not yet been set.</p>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A vector of <em>unscaled</em> MSD values the same length as <code>t</code>.  That is, for the drift-subtracted process <code>X_sub(t) = X(t) - drift(t) * mu</code>, the method returns <code>eta(t)</code> where</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>MSD_{X_sub}(t) <span class="ot">=</span> <span class="fu">trace</span>(Sigma) <span class="sc">*</span> <span class="fu">eta</span>(t).</span></code></pre><p></p></div>
</div>

</div><p></p><hr><a id="method-csi_model-drift"></a><div class="section">
<h3 id="method-drift-">Method <code>drift()</code><a class="anchor" aria-label="anchor" href="#method-drift-"></a></h3>
<p>Increment autocorrelation function.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">drift</span><span class="op">(</span><span class="va">phi</span>, <span class="va">dt</span>, <span class="va">N</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>dt</code></dt>
<dd><p>Interobservation time.</p></dd>


<dt><code>N</code></dt>
<dd><p>Number of trajectory increments.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>An <code>N x n_drift</code> matrix of drift basis functions.</p>
</div>

</div><p></p><hr><a id="method-csi_model-get_omega"></a><div class="section">
<h3 id="method-get-omega-">Method <code>get_omega()</code><a class="anchor" aria-label="anchor" href="#method-get-omega-"></a></h3>
<p>Combine kernel parameters with conditional MLE of <code>mu</code> and <code>Sigma</code>.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">get_omega</span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>psi</code></dt>
<dd><p>Kernel parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>Named vector of full parameter set in the computational basis.</p>
</div>

</div><p></p><hr><a id="method-csi_model-trans_full"></a><div class="section">
<h3 id="method-trans-full-">Method <code>trans_full()</code><a class="anchor" aria-label="anchor" href="#method-trans-full-"></a></h3>
<p>Convert from original to computational basis.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">trans_full</span><span class="op">(</span><span class="va">phi</span>, <span class="va">mu</span>, <span class="va">Sigma</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>mu</code></dt>
<dd><p>Drift coefficients.</p></dd>


<dt><code>Sigma</code></dt>
<dd><p>Scale matrix.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>Full parameter vector in the computational basis.</p>
</div>

</div><p></p><hr><a id="method-csi_model-itrans_full"></a><div class="section">
<h3 id="method-itrans-full-">Method <code>itrans_full()</code><a class="anchor" aria-label="anchor" href="#method-itrans-full-"></a></h3>
<p>Convert from computational to original basis.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">itrans_full</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>omega</code></dt>
<dd><p>Vector of parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>List with elements <code>phi</code>, <code>mu</code>, and <code>Sigma</code>.</p>
</div>

</div><p></p><hr><a id="method-csi_model-nlp"></a><div class="section">
<h3 id="method-nlp-">Method <code>nlp()</code><a class="anchor" aria-label="anchor" href="#method-nlp-"></a></h3>
<p>Evaluate the negative profile loglikelihood.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">nlp</span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>psi</code></dt>
<dd><p>Kernel parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>Value of the negative profile loglikelihood (scalar).</p>
</div>

</div><p></p><hr><a id="method-csi_model-nu_hat"></a><div class="section">
<h3 id="method-nu-hat-">Method <code>nu_hat()</code><a class="anchor" aria-label="anchor" href="#method-nu-hat-"></a></h3>
<p>Conditional MLE of nuisance parameters.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">nu_hat</span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>A list with elements <code>mu</code> and <code>Sigma</code>.</p>
</div>

</div><p></p><hr><a id="method-csi_model-loglik"></a><div class="section">
<h3 id="method-loglik-">Method <code>loglik()</code><a class="anchor" aria-label="anchor" href="#method-loglik-"></a></h3>
<p>Evaluate the loglikelihood function.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">loglik</span><span class="op">(</span><span class="va">phi</span>, <span class="va">mu</span>, <span class="va">Sigma</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>mu</code></dt>
<dd><p>Drift coefficients.</p></dd>


<dt><code>Sigma</code></dt>
<dd><p>Scale matrix.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>Value of the loglikelihood (scalar).</p>
</div>

</div><p></p><hr><a id="method-csi_model-fisher"></a><div class="section">
<h3 id="method-fisher-">Method <code>fisher()</code><a class="anchor" aria-label="anchor" href="#method-fisher-"></a></h3>
<p>Calculate the observed Fisher information matrix.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">fisher</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>omega</code></dt>
<dd><p>Vector of length <code>n_omega</code> of parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>The <code>n_omega x n_omega</code> observed Fisher information matrix.</p>
</div>

</div><p></p><hr><a id="method-csi_model-get_vcov"></a><div class="section">
<h3 id="method-get-vcov-">Method <code>get_vcov()</code><a class="anchor" aria-label="anchor" href="#method-get-vcov-"></a></h3>
<p>Convert a Fisher information matrix to a variance matrix.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">get_vcov</span><span class="op">(</span><span class="va">fi</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>fi</code></dt>
<dd><p>Fisher information matrix of size <code>n_omega x n_omega</code> with parameters in the computational basis.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>Variance matrix of size <code>n_omega x n_omega</code> with parameters in the computational basis.</p>
</div>

</div><p></p><hr><a id="method-csi_model-fit"></a><div class="section">
<h3 id="method-fit-">Method <code>fit()</code><a class="anchor" aria-label="anchor" href="#method-fit-"></a></h3>
<p>Calculate the maximum likelihood parameter values.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">psi0</span>, vcov <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>psi0</code></dt>
<dd><p>Vector of kernel parameter values (on the computational scale) to initialize the optimization if <code>n_phi &gt; 1</code>.  If <code>n_phi == 1</code>, a vector of length 2 giving the range in which to perform the optimum search.</p></dd>


<dt><code>vcov</code></dt>
<dd><p>Whether to also calculate the MLE variance estimate.</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> or <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">stats::optimize()</a></code> for <code>n_phi == 1</code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>A list with elements <code>coef</code> and optionally <code>vcov</code> containing the MLE in the computational basis and its variance estimate.</p>
</div>

</div><p></p><hr><a id="method-csi_model-resid"></a><div class="section">
<h3 id="method-resid-">Method <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid()</a></code><a class="anchor" aria-label="anchor" href="#method-resid-"></a></h3>
<p>Calculate the model residuals.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">resid</span><span class="op">(</span><span class="va">phi</span>, <span class="va">mu</span>, <span class="va">Sigma</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>mu</code></dt>
<dd><p>Drift coefficients.</p></dd>


<dt><code>Sigma</code></dt>
<dd><p>Scale matrix.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>A matrix of residuals the same size as <code>dX</code> as calculated with <code><a href="csi_resid.html">csi_resid()</a></code>, upon using the model's <code>drift()</code> and <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf()</a></code> specifications.</p>
</div>

</div><p></p><hr><a id="method-csi_model-sim"></a><div class="section">
<h3 id="method-sim-">Method <code>sim()</code><a class="anchor" aria-label="anchor" href="#method-sim-"></a></h3>
<p>Simulate trajectories from the model.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">sim</span><span class="op">(</span><span class="va">phi</span>, <span class="va">mu</span>, <span class="va">Sigma</span>, nsim <span class="op">=</span> <span class="fl">1</span>, fft <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">nkeep</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>phi</code></dt>
<dd><p>Kernel parameters in the original basis.</p></dd>


<dt><code>mu</code></dt>
<dd><p>Drift coefficients.</p></dd>


<dt><code>Sigma</code></dt>
<dd><p>Scale matrix.</p></dd>


<dt><code>nsim</code></dt>
<dd><p>Number of trajectories to simulate.</p></dd>


<dt><code>fft, nkeep, tol</code></dt>
<dd><p>Optional arguments to <code><a href="https://rdrr.io/pkg/SuperGauss/man/rnormtz.html" class="external-link">SuperGauss::rnormtz()</a></code>.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>A matrix of size <code>dim(Xt)</code> or an array of size <code>nrow(Xt) x ncol(dX) x nsim</code> array when <code>nsim &gt; 1</code> of simulated trajectories, as calculated with <code><a href="csi_sim.html">csi_sim()</a></code>, using the model's <code>drift()</code> and <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf()</a></code> specifications.</p>
</div>

</div><p></p><hr><a id="method-csi_model-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Model object constructor.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/csi_model.html">csi_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">Xt</span>, <span class="va">dt</span>, drift <span class="op">=</span> <span class="st">"linear"</span>, <span class="va">n_drift</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>Xt</code></dt>
<dd><p>Matrix of particle positions.</p></dd>


<dt><code>dt</code></dt>
<dd><p>Interobservation time.</p></dd>


<dt><code>drift</code></dt>
<dd><p>Drift specification.  Either one of the strings "none", "linear", "quadratric", or a function with signature <code>function(phi, dt, N)</code>.</p></dd>


<dt><code>n_drift</code></dt>
<dd><p>Integer number of drift terms.  Ignored if <code>drift</code> is one of the default strings.  Required otherwise.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>The value of <code>n_phi</code> is automatically determined from <code>phi_names</code>.  But this means the latter must be set by <code>derived$initialize()</code> before <code>super$initialize()</code> is called.  Otherwise an error is thrown.</p>
<p>The constructor can be called without <code>Xt</code> for accessing methods which don't require it, e.g.,</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>derived<span class="sc">$</span><span class="fu">new</span>(<span class="at">dt =</span> dt)<span class="sc">$</span><span class="fu">acf</span>(phi, dt, N)</span></code></pre><p></p></div>
<p><em>Development Notes</em></p><ul><li><p>Should a validator be (optionally) called after the constructor?</p></li>
<li><p>Should <code>psi</code> necessarily contain the origin, to facilitate the validator?</p></li>
</ul></div>


</div><p></p><hr><a id="method-csi_model-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">csi_model</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-17">Arguments<a class="anchor" aria-label="anchor" href="#arguments-17"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><!-- load mathjax after it has been configured --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><div class="copyright">
  <!-- <p>Copyright 2017-2019 Martin Lysy</p> -->
  <script>
    function get_date() {
	// return "aaaa";
	var x = new Date(Date.parse(document.lastModified));
	var d = x.getDate();
	var m = x.getMonth() + 1;
	var y = x.getYear();
	// different on IE and NS
	if(y >= 2000)
	{
	    y -= 2000;
	}
	if(y >= 100)
	{
	    y -= 100;
	}
	y = y + 2000;
	// x = new Date(x);
	// return x.getMonth();
	return "" + m + "/" + d + "/" + y;
    }
  </script><p>Last updated: <script> document.write(get_date()) </script></p>


      
   </div>






  </footer></div></body></html>

